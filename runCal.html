<!DOCTYPE html>
<html>
<title>
Calculate Player running time
</title>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script> -->
</head>
</script>	
<script type="text/javascript">
function showHint(str)
{
var xmlhttp;

        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
                  if (xmlhttp.readyState==4 && xmlhttp.status==200)      
                  {
                        var result=xmlhttp.responseText;
                        var html = result;
                      /*    
                        var obj = JSON.parse(result);//解析json字串為json物件形式
                                                
                        var html = '<table border=1 width=100%>';//
                        
                        for (var i = 0; i < obj.length; i ++ ) {//
                                html  += '<tr>';//
                                for(j=0;j<obj[i].data.length;j++)
                                {
                                  html+= '<td>'+obj[i].data[j]+'</td>'; 
                                }
                                html  += '</tr>';            
                        }
                        html+="</table>";
                      */  
                        //document.getElementById("playerList").innerHTML="跑友名稱 : " + html
			document.getElementById("playerSelect").innerHTML="選擇跑友名稱 : " + dynamicDropdownList(html);
                        if(html.length==0) //只有一筆代表查不到資料
                                alert('查無資料');
                  }

          }
    //var url="https://script.google.com/macros/s/AKfycbwgW-Luy9vwtDohR7qD91Uq_atyW3GPlthO4-lPPpGUoDjU7uLhmKtUCuPZWpj8twTp/exec";
    //var url="https://script.google.com/macros/s/AKfycbxEJPAjgOd9anMf-vz8DnWG9RFEx07N-dA9NmiFyiCJ3aAaVw5lKPrnDf1lj4s-A-A/exec";
    var url="https://script.google.com/macros/s/AKfycbzeeQ9NX3yY4Pc7eHEfXmtZ-x0ym2n3FAcgeelr8mHjoFXKXDaZw0NOnH3LcoCscWc/exec";
        //xmlhttp.open("get",url+"?uid="+encodeURIComponent(str),true);
        xmlhttp.open("get",url,true);
        xmlhttp.send();
}
</script>
<body onload="showHint(11)">


<center>


<br />


 



<h1>參考(0:30 , 1:30, 2:30)</h1>
<div style="padding:16px;">
預計完成時間 : <input type="textbox" value="2:57" onkeypress="return checkNumber(event)" id="estTime"></input><br>
<input type="radio" id="radioFull" value="full" name="group" checked onclick="handleClick(this);">全馬
<input type="radio" id="radioHalf" value="half" name="group" onclick="handleClick(this);">半馬
<input type="radio" id="radio10K" value="10K" name="group" onclick="handleClick(this);">10K
</div>
<span id="playerList"></span><br>
<span id="playerSelect"></span>	
<div id="div1">
<h2>跑友 : <label id="msg0"></label></h2>	
<h2>配速 : <label id="msg1"></label></h2>
<h2>快*0.97: <label id="msg2"></label></h2>
<h2>慢*1.1: <label id="msg3"></label></h2>
<h2>慢*1.15: <label id="msg4"></label></h2>	
<h2>400M: <label id="msg5"></label></h2>	
<h2>400M快*0.97: <label id="msg6"></label></h2>	
<h2>400M慢*1.1: <label id="msg7"></label></h2>	
<h2>400M慢*1.15: <label id="msg8"></label></h2>		
</div>
	
<button id="Get">Calcuate</button> 
<button id="Reset">Reset It</button>
<button id="Copy" onclick="CopyToClipboard('div1')">Copy It</button>



</body>





<script language="javascript" type="text/javascript">
function formattingTime() {
    var count = 0; //document.getElementById('kmh').value;
    var time = '';
    var second = count % 60;
    var minute = parseInt(parseInt(count) / 60) % 60;
    time = second + "秒";
     if (minute >= 1 ) {
       time = minute + "分" + second + "秒";
     }
     var hour = parseInt( parseInt(parseInt(count/60)/60)%24);
     if (hour >= 1) {
       time = hour + "小時" + minute + "分" + second + "秒";
     } else {
       time = minute + "分" + second + "秒";
     }
     var day = parseInt( parseInt(parseInt(count/60)/60)/24);
     if (day >= 1) {
       time = day + "天" + hour + "小時" + minute + "分" + second + "秒";
     }
   return time;
}

function checkNumber(event) {

var aCode = event.which ? event.which : event.keyCode;
//alert(aCode);

if (aCode > 31 && (aCode < 48 || aCode > 58)) return false;

return true;

}

	
//This method calls on button click
function dynamicDropdownList(source){
    var myArray = source.split(",");
    var dropdownHTML = '<select id="combo" onchange="getCombo(this)">';
    var firstRunner="";
    var firstEstTime="";
    var firstOption="";
    for(var i=0;i<myArray.length;i++){
        var value = myArray[i];   
        var minValue = value.split("#");     
        if (firstRunner.length == 0){
           firstRunner = minValue[0];
        }
        if (firstEstTime.length == 0){
           firstEstTime = minValue[2];
        }
        if (firstOption.length == 0){
           firstOption = minValue[1];
        }
        if (typeof(minValue[2]) != 'undefined') {
           document.getElementById("estTime").value=minValue[2];
           dropdownHTML+='<option value="'+minValue[0]+'#'+minValue[1]+'#'+minValue[2]+'">'+minValue[0]+'  Time:'+minValue[2]+'</option>';
	} else {
           document.getElementById("estTime").value="";
           dropdownHTML+='<option value="'+minValue[1]+'#'+minValue[2]+'">'+minValue[0]+'  Time:</option>';
        }
        if (minValue[1] === 'FULL') {
           document.getElementById("radioFull").checked = true;
        }
        if (minValue[1] === 'HALF') {
           document.getElementById("radioHalf").checked = true;
        }
        if (minValue[1] === '10K') {
           document.getElementById("radio10K").checked = true;
        }        
    }
    dropdownHTML+='</select>';        
    //Load the dynamically created dropdown in container
    //var container=document.getElementById("dropdown-container");

    $('#msg0').html(firstRunner);	             
    if (firstOption === 'FULL') {
       document.getElementById("radioFull").checked = true;
    }
    if (firstOption === 'HALF') {
       document.getElementById("radioHalf").checked = true;
    }
    if (firstOption === '10K') {
       document.getElementById("radio10K").checked = true;
    } 
    document.getElementById("estTime").value=firstEstTime;
    return dropdownHTML;
}	

function getCombo(selectObject) {
  var value = selectObject.value.split("#");  
  document.getElementById("estTime").value=value[2];
  $('#msg0').html(value[0]);	             
  if (value[1] === 'FULL') {
     document.getElementById("radioFull").checked = true;
  }
  if (value[1] === 'HALF') {
     document.getElementById("radioHalf").checked = true;
  }
  if (value[1] === '10K') {
     document.getElementById("radio10K").checked = true;
  }        
  console.log(value);
}
	
function convertH2M(timeInHour){
  var timeParts = timeInHour.split(":");
  return Number(timeParts[0]) * 60 + Number(timeParts[1]);
}

	
function CopyToClipboard(containerid) {
  if (document.selection) {
    var range = document.body.createTextRange();
    range.moveToElementText(document.getElementById(containerid));
    range.select().createTextRange();
    document.execCommand("copy"); 
    alert("成功複製");
  } else if (window.getSelection) {
    var range = document.createRange();
    range.selectNode(document.getElementById(containerid));
    window.getSelection().addRange(range);
    document.execCommand("copy");
    alert("成功複製");
  }
}

function handleClick(myRadio) {
    //alert('New value: ' + myRadio.value);
    var runOpt = document.querySelector('input[name="group"]:checked').value;
    if (runOpt === 'HALF'){
       document.getElementById("estTime").value="1:30";
    } else if (runOpt === 'FULL'){
       document.getElementById("estTime").value="2:57";
    } else if (runOpt === '10K'){
       document.getElementById("estTime").value="0:40";
    }   
}


</script>

<script type="text/javascript">
    $(document).ready(function() {
        var kmh = $('kmh');
        var kk = $('#kk');
        kk.click(function() {
            alert(kmh.val());
            document.getElementById("demo").innerHTML = kmh.val();
        });
    });
</script>



<script type="text/javascript">
    $("button:#Get").click(function () {
	 var runOpt = document.querySelector('input[name="group"]:checked').value;	
         var count = convertH2M($('input:textbox').val());
         var half = 21.0975;
         var full = 42.195;

         var target_min = 0;
         var target_sec = 0;
         var target_min_400 = 0;
         var target_sec_400 = 0;         
         var fast_min = 0;
         var fast_sec = 0;
	 var fast_min_400 = 0;   
         var slow_min = 0;
         var slow_sec = 0;
	 var slow_min_400 = 0;   
         var slow_min2 = 0;
         var slow_sec2 = 0;	    
	 var slow_min2_400 = 0;   
         if (runOpt === 'HALF'){
           target_min = parseInt( count / half);
           target_sec = (((count / half) - target_min) * 60) / 100 ;
           target_sec = parseFloat(target_sec).toFixed(2);
	   target_sec = target_sec.toString();
           target_sec = target_sec.replace("0.","");
           target_min_400 = (((parseInt(target_min) * 60) + parseInt(target_sec)) / 1000) * 400;

           fast_min = parseInt( (count * 0.97) / half);
           fast_sec = ((((count * 0.97) / half) - fast_min) * 60) / 100 ;
           fast_sec = parseFloat(fast_sec).toFixed(2);
	   fast_sec = fast_sec.toString();
           fast_sec = fast_sec.replace("0.","");
	   fast_min_400 = (((parseInt(fast_min) * 60) + parseInt(fast_sec)) / 1000) * 400;

           slow_min = parseInt( (count * 1.1) / half);
           slow_sec = ((((count * 1.1)/ half) - slow_min) * 60) / 100 ;
           slow_sec = parseFloat(slow_sec).toFixed(2);
	   slow_sec = slow_sec.toString();
           slow_sec = slow_sec.replace("0.","");
           slow_min_400 = (((parseInt(slow_min) * 60) + parseInt(slow_sec)) / 1000) * 400;
		 
           slow_min2 = parseInt( (count * 1.15) / half);
           slow_sec2 = ((((count * 1.15)/ half) - slow_min2) * 60) / 100 ;
           slow_sec2 = parseFloat(slow_sec2).toFixed(2);
	   slow_sec2 = slow_sec2.toString();
           slow_sec2 = slow_sec2.replace("0.","");		 
           slow_min2_400 = (((parseInt(slow_min2) * 60) + parseInt(slow_sec2)) / 1000) * 400;		 

         } else if (runOpt === 'FULL'){
           target_min = parseInt( count / full);
           target_sec = (((count / full) - target_min) * 60) / 100 ;
           target_sec = parseFloat(target_sec).toFixed(2);
	   target_sec = target_sec.toString();
           target_sec = target_sec.replace("0.","");
           target_min_400 = (((parseInt(target_min) * 60) + parseInt(target_sec)) / 1000) * 400;

           fast_min = parseInt( (count * 0.97) / full);
           fast_sec = ((((count * 0.97) / full) - fast_min) * 60) / 100 ;
           fast_sec = parseFloat(fast_sec).toFixed(2);
	   fast_sec = fast_sec.toString();
           fast_sec = fast_sec.replace("0.","");
	   fast_min_400 = (((parseInt(fast_min) * 60) + parseInt(fast_sec)) / 1000) * 400;	 

           slow_min = parseInt( (count * 1.1) / full);
           slow_sec = ((((count * 1.1)/ full) - slow_min) * 60) / 100 ;
           slow_sec = parseFloat(slow_sec).toFixed(2);
	   slow_sec = slow_sec.toString();
           slow_sec = slow_sec.replace("0.","");
           slow_min_400 = (((parseInt(slow_min) * 60) + parseInt(slow_sec)) / 1000) * 400;		 

           slow_min2 = parseInt( (count * 1.15) / full);
           slow_sec2 = ((((count * 1.15)/ full) - slow_min2) * 60) / 100 ;
           slow_sec2 = parseFloat(slow_sec2).toFixed(2);
	   slow_sec2 = slow_sec2.toString();
           slow_sec2 = slow_sec2.replace("0.","");
	   slow_min2_400 = (((parseInt(slow_min2) * 60) + parseInt(slow_sec2)) / 1000) * 400;		 	 
         }  else if (runOpt === '10K'){
           target_min = parseInt( count / full);
           target_sec = (((count / full) - target_min) * 60) / 100 ;
           target_sec = parseFloat(target_sec).toFixed(2);
	   target_sec = target_sec.toString();
           target_sec = target_sec.replace("0.","");
           target_min_400 = (((parseInt(target_min) * 60) + parseInt(target_sec)) / 1000) * 400;

           fast_min = parseInt( (count * 0.97) / full);
           fast_sec = ((((count * 0.97) / full) - fast_min) * 60) / 100 ;
           fast_sec = parseFloat(fast_sec).toFixed(2);
	   fast_sec = fast_sec.toString();
           fast_sec = fast_sec.replace("0.","");
	   fast_min_400 = (((parseInt(fast_min) * 60) + parseInt(fast_sec)) / 1000) * 400;	 

           slow_min = parseInt( (count * 1.1) / full);
           slow_sec = ((((count * 1.1)/ full) - slow_min) * 60) / 100 ;
           slow_sec = parseFloat(slow_sec).toFixed(2);
	   slow_sec = slow_sec.toString();
           slow_sec = slow_sec.replace("0.","");
           slow_min_400 = (((parseInt(slow_min) * 60) + parseInt(slow_sec)) / 1000) * 400;		 

           slow_min2 = parseInt( (count * 1.15) / full);
           slow_sec2 = ((((count * 1.15)/ full) - slow_min2) * 60) / 100 ;
           slow_sec2 = parseFloat(slow_sec2).toFixed(2);
	   slow_sec2 = slow_sec2.toString();
           slow_sec2 = slow_sec2.replace("0.","");
	   slow_min2_400 = (((parseInt(slow_min2) * 60) + parseInt(slow_sec2)) / 1000) * 400;		 	 
         }


         var time = '';
  
         if (target_min >= 1 ) {
            //time = target_min + "分" + target_sec + "秒";
	    time = (((parseInt(target_min) * 60) + parseInt(target_sec)));
            $('#msg1').html(new Date(time * 1000).toISOString().substr(14, 5));	             
	    time = "";	 
            //time = fast_min + "分" + fast_sec + "秒";
            time = (((parseInt(fast_min) * 60) + parseInt(fast_sec)));
	    $('#msg2').html(new Date(time * 1000).toISOString().substr(14, 5));	             
            time = "";
            //time = slow_min + "分" + slow_sec + "秒";
	    time = (((parseInt(slow_min) * 60) + parseInt(slow_sec)));	 
            $('#msg3').html(new Date(time * 1000).toISOString().substr(14, 5));	             
	    time = "";	 
            //time = slow_min2 + "分" + slow_sec2 + "秒";
	    time = (((parseInt(slow_min2) * 60) + parseInt(slow_sec2)));	 	 
            $('#msg4').html(new Date(time * 1000).toISOString().substr(14, 5));	             

            $('#msg5').html(new Date(target_min_400 * 1000).toISOString().substr(14, 5));

            $('#msg6').html(new Date(fast_min_400 * 1000).toISOString().substr(14, 5));

            $('#msg7').html(new Date(slow_min_400 * 1000).toISOString().substr(14, 5));

            $('#msg8').html(new Date(slow_min2_400 * 1000).toISOString().substr(14, 5));		 		 
            return;
         }



         if (count > 120){
           var second = full_hour % 60;
         } else {
           var second = half_hour % 60;
         }
         
         var minute = parseInt(parseInt(count) / 60) % 60;
         time = second + "秒";
          if (minute >= 1 ) {
            time = minute + "分" + second + "秒";
          }
          var hour = parseInt( parseInt(parseInt(count/60)/60)%24);
          if (hour >= 1) {
            time = hour + "小時" + minute + "分" + second + "秒";
          } else {
            time = 0 + "小時" + minute + "分" + second + "秒";
          }
          var day = parseInt( parseInt(parseInt(count/60)/60)/24);
          if (day >= 1) {
            time = day + "天" + hour + "小時" + minute + "分" + second + "秒";
          }


//	$('#msg').html($('input:textbox').val());
	$('#msg').html(time);
		
    });
	
    $("button:#Reset").click(function () {
		
	$('#msg').html("");
	$('input:textbox').val("");
		
    });
	
    $("button:#Set").click(function () {
		
	$('input:textbox').val("ABC");
	$('#msg').html($('input:textbox').val());
		
    });
	
</script>

</html>


